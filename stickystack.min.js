/* @preserve
 *
 * StickyStack
 *
 * A vanilla javascript sticky-element stacker
 *
 * For licence details and usage see:
 * https://github.com/jrsouth/stickystack
 *
 */
!function(){"use strict";let e={mobileBreak:768,list:[],number:0,stackTop:0,init:function(){e.stopObserving();for(let t=0;t<e.number;t++){let s=e.list[t].placeholder,o=e.list[t].element;s.parentNode.removeChild(s),e.removeClass(o,"stickystack-stuck"),o.style.position=null,o.style.top=null,o.style.left=null,o.style.width=null,o.style.marginTop=null,o.style.marginBottom=null}e.number=0;let t=document.getElementsByClassName("js-stickystack");if(window.innerWidth<=e.mobileBreak){let s=[];for(let o=0;o<t.length;o++)e.hasClass(t[o],"js-stickystack-nomobile")||s.push(t[o]);t=s}e.number=t.length,e.list=[],e.stackTop=0;for(let s=0;s<e.number;s++){let o=window.getComputedStyle(t[s]),l=document.createElement("div");l.style.width=o.getPropertyValue("width"),l.style.height=o.getPropertyValue("height"),l.style.top=o.getPropertyValue("top"),l.style.right=o.getPropertyValue("right"),l.style.bottom=o.getPropertyValue("bottom"),l.style.left=o.getPropertyValue("left"),l.style.margin=o.getPropertyValue("margin"),l.style.padding=o.getPropertyValue("padding"),l.style.border=o.getPropertyValue("border"),l.style.float=o.getPropertyValue("float"),l.style.clear=o.getPropertyValue("clear"),l.style.position=o.getPropertyValue("position"),l.style.display="none",l.style.visibility="hidden",t[s].parentNode.insertBefore(l,t[s]);let n=e.getCoords(t[s]);e.list.push({element:t[s],top:n.top,left:n.left-parseFloat(o.getPropertyValue("margin-left")),width:parseFloat(o.getPropertyValue("width")),placeholder:l,semistuck:e.hasClass(t[s],"js-stickystack-semi"),zIndex:100-s})}e.list.sort(e.sortByTop),e.stackTop=0,t=document.getElementsByClassName("js-stickystack-top");for(let s=0;s<t.length;s++){let o=e.getCoords(t[s]).top;e.stackTop=0==s?o:Math.min(e.stackTop,o)}e.update(),e.startObserving()},update:function(){let t=[[e.stackTop,0,document.body.offsetWidth]],s=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;for(let o=0;o<e.number;o++){let l=e.list[o],n=l.element,i=l.placeholder,r=l.left,a=l.top-s,d=l.width,u=e.getOverlap([a,r,d],t);if(u.overlap>0){i.style.display="block",e.addClass(n,"stickystack-stuck");let a=0;if(e.list[o].semistuck&&o+1<e.number){let t=[[u.absolute+n.offsetHeight,r,d]];for(let l=o+1;l<e.number;l++){let o=[e.list[l].top-s,e.list[l].left,e.list[l].width],n=e.getOverlap(o,t);if(n.overlap>0){a=n.overlap;break}}}n.style.position="fixed",n.style.top=u.absolute-a+"px",n.style.left=r+"px",n.style.width=d+"px",n.style.zIndex=l.zIndex,n.style.marginTop=0,n.style.marginBottom=0,t.push([u.absolute+n.offsetHeight-a,n.offsetLeft,n.offsetWidth])}else e.removeClass(n,"stickystack-stuck"),n.style.position=null,n.style.top=null,n.style.left=null,n.style.width=null,n.style.zIndex=null,n.style.marginTop=null,n.style.marginBottom=null,i.style.display="none"}},startObserving:function(){if(e.observer)e.observer.disconnect();else{let t=window.MutationObserver||window.WebKitMutationObserver;e.observer=new t(e.init)}e.observer.observe(document.body,{attributes:!0,characterData:!0,subtree:!0})},stopObserving:function(){e.observer&&e.observer.disconnect()},getOverlap:function(e,t){let s=0,o=0;for(let l=0;l<t.length;l++)e[0]<t[l][0]&&e[1]+e[2]>t[l][1]&&t[l][1]+t[l][2]>e[1]&&(s=Math.max(s,t[l][0]-e[0]),o=Math.max(o,t[l][0]));return{overlap:s,absolute:o}},sortByTop:function(e,t){return e.top-t.top},getCoords:function(e){let t=e.getBoundingClientRect(),s=document.body,o=document.documentElement,l=window.pageYOffset||o.scrollTop||s.scrollTop,n=window.pageXOffset||o.scrollLeft||s.scrollLeft,i=o.clientTop||s.clientTop||0,r=o.clientLeft||s.clientLeft||0,a=t.top+l-i,d=t.left+n-r;return{top:Math.round(a),left:Math.round(d)}},hasClass:function(e,t){return e.classList?e.classList.contains(t):!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},addClass:function(t,s){t.classList?t.classList.add(s):e.hasClass(t,s)||(t.className+=" "+s)},removeClass:function(t,s){if(t.classList)t.classList.remove(s);else if(e.hasClass(t,s)){var o=new RegExp("(\\s|^)"+s+"(\\s|$)");t.className=t.className.replace(o," ")}}};window.addEventListener("DOMContentLoaded",e.init),window.addEventListener("load",e.init),window.addEventListener("resize",e.init),window.addEventListener("scroll",e.update),window.addEventListener("touchmove",e.update),window.ontouchstart=function(){},window.addEventListener("DOMContentLoaded",function(){setTimeout(function(){e.update()},500)}),window.addEventListener("load",function(){setTimeout(function(){e.update()},500)})}();