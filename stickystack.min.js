/* @preserve
 *
 * StickyStack
 *
 * A vanilla javascript sticky-element stacker
 *
 * For licence details and usage see:
 * https://github.com/jrsouth/stickystack
 *
 */
!function(){"use strict";let t={mobileBreak:768,list:[],number:0,stackTop:0,pageBottom:null,init:function(){t.stopObserving(),t.pageBottom&&t.pageBottom.parentNode.removeChild(t.pageBottom);for(let e=0;e<t.number;e++){let o=t.list[e].placeholder,s=t.list[e].element;o.parentNode.removeChild(o),t.removeClass(s,"stickystack-stuck"),s.style.position=null,s.style.top=null,s.style.left=null,s.style.width=null,s.style.marginTop=null,s.style.marginBottom=null}t.pageBottom=document.createElement("div"),t.pageBottom.style.height=0,t.pageBottom.style.width="100%",t.addClass(t.pageBottom,"js-stickystack"),document.body.appendChild(t.pageBottom),t.number=0;let e=document.getElementsByClassName("js-stickystack");if(window.innerWidth<=t.mobileBreak){let o=[];for(let s=0;s<e.length;s++)t.hasClass(e[s],"js-stickystack-nomobile")||o.push(e[s]);e=o}t.number=e.length,t.list=[],t.stackTop=0;for(let o=0;o<t.number;o++){let s=window.getComputedStyle(e[o]),l=document.createElement("div");l.style.width=s.getPropertyValue("width"),l.style.height=s.getPropertyValue("height"),l.style.top=s.getPropertyValue("top"),l.style.right=s.getPropertyValue("right"),l.style.bottom=s.getPropertyValue("bottom"),l.style.left=s.getPropertyValue("left"),l.style.margin=s.getPropertyValue("margin"),l.style.padding=s.getPropertyValue("padding"),l.style.border=s.getPropertyValue("border"),l.style.float=s.getPropertyValue("float"),l.style.clear=s.getPropertyValue("clear"),l.style.position=s.getPropertyValue("position"),l.style.display="none",l.style.visibility="hidden",e[o].parentNode.insertBefore(l,e[o]);let n=t.getCoords(e[o]);t.list.push({element:e[o],top:n.top,left:n.left-parseFloat(s.getPropertyValue("margin-left")),width:parseFloat(s.getPropertyValue("width")),placeholder:l,semistuck:t.hasClass(e[o],"js-stickystack-semi"),zIndex:100-o})}t.list.sort(t.sortByTop),t.stackTop=0,e=document.getElementsByClassName("js-stickystack-top");for(let o=0;o<e.length;o++){let s=t.getCoords(e[o]).top;t.stackTop=0==o?s:Math.min(t.stackTop,s)}t.update(),t.startObserving()},update:function(){let e=[[t.stackTop,0,document.body.offsetWidth]],o=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;for(let s=0;s<t.number;s++){let l=t.list[s],n=l.element,i=l.placeholder,a=l.left,r=l.top-o,d=l.width,p=t.getOverlap([r,a,d],e);if(p.overlap>0){i.style.display="block",t.addClass(n,"stickystack-stuck");let r=0;if(t.list[s].semistuck&&s+1<t.number){let e=[[p.absolute+n.offsetHeight,a,d]];for(let l=s+1;l<t.number;l++){let s=[t.list[l].top-o,t.list[l].left,t.list[l].width],n=t.getOverlap(s,e);if(n.overlap>0){r=n.overlap;break}}}n.style.position="fixed",n.style.top=p.absolute-r+"px",n.style.left=a+"px",n.style.width=d+"px",n.style.zIndex=l.zIndex,n.style.marginTop=0,n.style.marginBottom=0,e.push([p.absolute+n.offsetHeight-r,n.offsetLeft,n.offsetWidth])}else t.removeClass(n,"stickystack-stuck"),n.style.position=null,n.style.top=null,n.style.left=null,n.style.width=null,n.style.zIndex=null,n.style.marginTop=null,n.style.marginBottom=null,i.style.display="none"}},startObserving:function(){if(t.observer)t.observer.disconnect();else{let e=window.MutationObserver||window.WebKitMutationObserver;t.observer=new e(t.init)}t.observer.observe(document.body,{attributes:!0,characterData:!0,subtree:!0})},stopObserving:function(){t.observer&&t.observer.disconnect()},getOverlap:function(t,e){let o=0,s=0;for(let l=0;l<e.length;l++)t[0]<e[l][0]&&t[1]+t[2]>e[l][1]&&e[l][1]+e[l][2]>t[1]&&(o=Math.max(o,e[l][0]-t[0]),s=Math.max(s,e[l][0]));return{overlap:o,absolute:s}},sortByTop:function(t,e){return t.top-e.top},getCoords:function(t){let e=t.getBoundingClientRect(),o=document.body,s=document.documentElement,l=window.pageYOffset||s.scrollTop||o.scrollTop,n=window.pageXOffset||s.scrollLeft||o.scrollLeft,i=s.clientTop||o.clientTop||0,a=s.clientLeft||o.clientLeft||0,r=e.top+l-i,d=e.left+n-a;return{top:Math.round(r),left:Math.round(d)}},hasClass:function(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))},addClass:function(e,o){e.classList?e.classList.add(o):t.hasClass(e,o)||(e.className+=" "+o)},removeClass:function(e,o){if(e.classList)e.classList.remove(o);else if(t.hasClass(e,o)){var s=new RegExp("(\\s|^)"+o+"(\\s|$)");e.className=e.className.replace(s," ")}}};window.addEventListener("DOMContentLoaded",t.init),window.addEventListener("load",t.init),window.addEventListener("resize",t.init),window.addEventListener("scroll",t.update),window.addEventListener("touchmove",t.update),window.ontouchstart=function(){},window.addEventListener("DOMContentLoaded",function(){setTimeout(function(){t.update()},500)}),window.addEventListener("load",function(){setTimeout(function(){t.update()},500)})}();